%%%%%%%%%%%%%%%%%%%%%%
%%% Vicon Exporter %%%
%%%%%%%%%%%%%%%%%%%%%%

% MATLAB via Chris Frauenberger wizardry

% Zero offsets
%%%%%%%%%%%%%%

offsets = {};
for i = 1:13
	offsets{i} = eye(3);
end

% Performance 1 Incantation
%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all

% Note: Performer is offsets{10} in viewer, need to shift to be offsets{1} here

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 3pm001 mk3.V', 10);
offsets{2} = [0.057179, -0.899591, -0.432974; 0.978076, 0.137460, -0.156434; 0.200244, -0.414537, 0.887728];
offsets{3} = [0.230327, -0.970629, -0.069491; 0.970662, 0.224095, 0.087156; -0.069023, -0.087527, 0.993768];
offsets{4} = [0.335895, -0.829025, -0.447093; 0.941776, 0.287930, 0.173648; -0.015227, -0.479390, 0.877470];
offsets{5} = [-0.294209, -0.850513, 0.435970; -0.922105, 0.372554, 0.104529; -0.251325, -0.371256, -0.893870];
offsets{6} = [-0.784102, 0.521281, -0.336824; -0.492404, -0.852869, -0.173648; -0.377786, 0.029696, 0.925417];
offsets{7} = [-0.052336, -0.998630, 0.000000; -0.997261, 0.052264, -0.052336; 0.052264, -0.002739, -0.998630];
offsets{8} = [0.958887, 0.225453, -0.172354; 0.206362, -0.970857, -0.121869; -0.194807, 0.081292, -0.977467];
offsets{9} = [-0.827584, 0.554543, 0.087103; 0.558852, 0.828533, 0.034899; -0.052814, 0.077560, -0.995588];
offsets{10} = [-0.938930, 0.277582, 0.203368; -0.318454, -0.924857, -0.207912; 0.130374, -0.259978, 0.956773];
offsets{1} = [-0.788800, 0.382419, 0.481196; 0.371814, 0.920273, -0.121869; -0.489437, 0.082785, -0.868100];
[poseHeaders1 poseData1 gazeHeaders1 gazeData1] = analyse(dofs, data, 464-0.3, 10, -1, offsets);

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 3pm002 mk5.V', 10);
offsets{2} = [0.057179, -0.899591, -0.432974; 0.978076, 0.137460, -0.156434; 0.200244, -0.414537, 0.887728];
offsets{3} = [0.229087, -0.972009, -0.052137; 0.970662, 0.224095, 0.087156; -0.073033, -0.070573, 0.994829];
offsets{4} = [-0.233941, -0.764757, 0.600349; -0.967932, 0.241333, -0.069756; -0.091537, -0.597416, -0.796690];
offsets{5} = [-0.294209, -0.850513, 0.435970; -0.922105, 0.372554, 0.104529; -0.251325, -0.371256, -0.893870];
offsets{6} = [-0.825727, 0.449185, 0.341187; 0.498782, 0.863916, 0.069756; -0.263423, 0.227778, -0.937404];
offsets{7} = [0.036427, -0.984250, -0.172987; 0.994829, 0.052137, -0.087156; 0.094802, -0.168918, 0.981060];
offsets{8} = [0.933272, 0.232715, -0.273583; 0.206362, -0.970857, -0.121869; -0.293971, 0.057280, -0.954097];
offsets{9} = [-0.827584, 0.554543, 0.087103; 0.558852, 0.828533, 0.034899; -0.052814, 0.077560, -0.995588];
offsets{10} = [0.939233, 0.332158, -0.086678; 0.340147, -0.934545, 0.104528; -0.046285, -0.127660, -0.990737];
offsets{1} = [-0.894740, 0.411623, 0.173225; 0.405746, 0.911320, -0.069756; -0.186577, 0.007872, -0.982409];
[poseHeaders2 poseData2 gazeHeaders2 gazeData2] = analyse(dofs, data, 789.2-0.5, 10, -1, offsets);

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 3pm003 mk1.V', 10);
offsets{2} = [-0.735852, 0.610792, 0.292327; 0.642690, 0.765928, 0.017452; -0.213242, 0.200718, -0.956159];
offsets{3} = [-0.927184, 0.374606, 0.000000; -0.374378, -0.926619, -0.034899; -0.013074, -0.032358, 0.999391];
offsets{4} = [-0.244380, -0.786981, 0.566515; -0.969542, 0.188460, -0.156434; 0.016346, -0.587489, -0.809067];
offsets{5} = [-0.273661, -0.631011, 0.725902; -0.954097, 0.273583, -0.121869; -0.121693, -0.725932, -0.676915];
offsets{6} = [-0.033710, -0.965337, -0.258819; 0.999391, -0.034899, 0.000000; -0.009033, -0.258661, 0.965926];
offsets{7} = [-0.188590, -0.978182, 0.087142; -0.981478, 0.190780, 0.017452; -0.033697, -0.082237, -0.996043];
offsets{8} = [0.944216, 0.240814, -0.224643; 0.258464, -0.964602, 0.052336; -0.204088, -0.107479, -0.973035];
offsets{9} = [0.204092, -0.960176, -0.190809; 0.978148, 0.207912, 0.000000; 0.039671, -0.186639, 0.981627];
offsets{10} = [0.941193, 0.336117, -0.034369; 0.336824, -0.925417, 0.173648; 0.026560, -0.175013, -0.984208];
offsets{1} = [0.446270, -0.805092, -0.390731; 0.874620, 0.484810, 0.000000; 0.189430, -0.341741, 0.920505];
[poseHeaders3 poseData3 gazeHeaders3 gazeData3] = analyse(dofs, data, 1109.6-0.2, 10, -1, offsets);

poseDataP1 = [poseData1; poseData2; poseData3];
gazeDataP1 = [gazeData1; gazeData2; gazeData3];
writeCSVFile(poseHeaders1, poseDataP1, 'TUESDAY 3pm 123.csv');

[glmmHeaders glmmData] = resultsForGLMM(poseHeaders1, poseDataP1, gazeDataP1);
writeCSVFile(glmmHeaders, glmmData, 'Performance 1 Mocap.csv');

% Performance 2 Incantation
%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 3pm005 mk1.V', 10);
dofs(:,1:12) = []; % delete clapperboard subject
data(:,1:12) = [];
offsets{1} = [-0.293893, -0.904508, -0.309017; 0.951056, -0.309017, 0.000000; -0.095492, -0.293893, 0.951057];
offsets{2} = [-0.751838, 0.653562, -0.087156; -0.656059, -0.754710, 0.000000; -0.065777, 0.057179, 0.996195];
offsets{3} = [0.990277, 0.067115, -0.121851; 0.069746, -0.997412, 0.017452; -0.120364, -0.025781, -0.992395];
offsets{4} = [0.427136, -0.875758, -0.224951; 0.898794, 0.438371, 0.000000; 0.098612, -0.202185, 0.974370];
offsets{5} = [0.188460, -0.969542, -0.156434; 0.981627, 0.190809, 0.000000; 0.029849, -0.153560, 0.987688];
offsets{6} = [0.075632, -0.715455, -0.694553; 0.992395, 0.121851, -0.017452; 0.097118, -0.687951, 0.719230];
offsets{7} = [0.730908, 0.681583, -0.034899; -0.681998, 0.731354, 0.000000; 0.025524, 0.023801, 0.999391];
offsets{8} = [-0.978539, 0.193928, 0.069661; -0.190548, -0.980282, 0.052336; 0.078437, 0.037939, 0.996197];
offsets{9} = [-0.724303, 0.490542, 0.484514; 0.544307, 0.838160, -0.034899; -0.423220, 0.238447, -0.874087];
offsets{10} = [0.878743, 0.474460, 0.051946; 0.465972, -0.876366, 0.121869; 0.103346, -0.082887, -0.991186];
[poseHeaders5 poseData5 gazeHeaders5 gazeData5] = analyse(dofs, data, 249.7, 10, -1, offsets);

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 3pm006 mk1.V', 10);
offsets{1} = [-0.278062, -0.909500, -0.309017; 0.956305, -0.292372, 0.000000; -0.090348, -0.295514, 0.951057];
offsets{2} = [0.085309, -0.992536, 0.087142; -0.996043, -0.087142, -0.017452; 0.024916, -0.085309, -0.996043];
offsets{3} = [0.990277, 0.067115, -0.121851; 0.069746, -0.997412, 0.017452; -0.120364, -0.025781, -0.992395];
offsets{4} = [0.427136, -0.875758, -0.224951; 0.898794, 0.438371, 0.000000; 0.098612, -0.202185, 0.974370];
offsets{5} = [0.180413, -0.928147, -0.325568; 0.981627, 0.190809, 0.000000; 0.062121, -0.319587, 0.945519];
offsets{6} = [0.075632, -0.715455, -0.694553; 0.992395, 0.121851, -0.017452; 0.097118, -0.687951, 0.719230];
offsets{7} = [0.730908, 0.681583, -0.034899; -0.681998, 0.731354, 0.000000; 0.025524, 0.023801, 0.999391];
offsets{8} = [0.978184, 0.204810, -0.034767; 0.207120, -0.974425, 0.087156; -0.016027, -0.092455, -0.995588];
offsets{9} = [-0.664095, 0.363090, -0.653563; -0.542567, -0.835479, 0.087156; -0.514393, 0.412481, 0.751838];
offsets{10} = [-0.938092, 0.342410, -0.052328; -0.341968, -0.939549, -0.017452; -0.055141, 0.001522, 0.998477];
[poseHeaders6 poseData6 gazeHeaders6 gazeData6] = analyse(dofs, data, 687, 10, -1, offsets);

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 3pm007 mk1.V', 10);
offsets{1} = [-0.278062, -0.909500, -0.309017; 0.956305, -0.292372, 0.000000; -0.090348, -0.295514, 0.951057];
offsets{2} = [-0.060403, -0.994404, -0.086678; 0.992099, -0.069374, 0.104528; -0.109957, -0.079680, 0.990737];
offsets{3} = [0.990277, 0.067115, -0.121851; 0.069746, -0.997412, 0.017452; -0.120364, -0.025781, -0.992395];
offsets{4} = [-0.343145, -0.912360, 0.223274; -0.938471, 0.323141, -0.121869; 0.039039, -0.251355, -0.967107];
offsets{5} = [0.174313, -0.896761, -0.406737; 0.981627, 0.190809, 0.000000; 0.077609, -0.399264, 0.913545];
offsets{6} = [0.083718, -0.854766, 0.512217; -0.993916, -0.034708, 0.104528; -0.071569, -0.517851, -0.852472];
offsets{7} = [0.718902, 0.694235, -0.034899; -0.694658, 0.719340, 0.000000; 0.025105, 0.024243, 0.999391];
offsets{8} = [0.694235, 0.718902, 0.034899; -0.719340, 0.694658, 0.000000; -0.024243, -0.025105, 0.999391];
offsets{9} = [0.143729, -0.746502, -0.649674; 0.987856, 0.069078, 0.139173; -0.059015, -0.661788, 0.747365];
offsets{10} = [-0.938092, 0.342410, -0.052328; -0.341968, -0.939549, -0.017452; -0.055141, 0.001522, 0.998477];
[poseHeaders7 poseData7 gazeHeaders7 gazeData7] = analyse(dofs, data, 999.7, 10, 3000, offsets);

poseDataP2 = [poseData5; poseData6; poseData7];
gazeDataP2 = [gazeData5; gazeData6; gazeData7];
writeCSVFile(poseHeaders5, poseDataP2, 'TUESDAY 3pm 567.csv');

[glmmHeaders glmmData] = resultsForGLMM(poseHeaders5, poseDataP2, gazeDataP2);
writeCSVFile(glmmHeaders, glmmData, 'Performance 2 Mocap.csv');

% Performance 2 Incantation w/ 'Virtual' Performance 1 Performer
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Run Performance 1 Incantation
% Run Performance 2 Incantation

% Retime P1 to P2

for i = 1:length(poseDataP1)
	if poseDataP1(i,1) < 467.1
		poseDataP1(i,1) = 0;
	elseif poseDataP1(i,1) < 940.9
		poseDataP1(i,1) = poseDataP1(i,1) - 176;
	elseif poseDataP1(i,1) < 1020.1
		poseDataP1(i,1) = poseDataP1(i,1) - 172.9;
	elseif poseDataP1(i,1) < 1105.6
		poseDataP1(i,1) = poseDataP1(i,1) - 170.7;
	elseif poseDataP1(i,1) < 1184.9
		poseDataP1(i,1) = poseDataP1(i,1) - 168;
	elseif poseDataP1(i,1) < 1285.4
		poseDataP1(i,1) = poseDataP1(i,1) - 165.7 + 0.7;
	else
		poseDataP1(i,1) = poseDataP1(i,1) - 164 + 0.7;
	end
end

writeCSVFile(poseHeaders1, poseDataP1, 'TUESDAY 3pm 123 Timed as per P2.csv');

% Performance 3 Test Incantation for 15m00
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 5pm002 mk5.V', 10);
data15m00 = data(6023:6623, :); %15m00s - 16m00s

[poseHeaders poseData gazeHeaders gazeData] = analyse(dofs, data15m00, 900, 10, -1, offsets);
writeCSVFile(poseHeaders, poseData, 'TUESDAY 5pm 002 15m00s.csv');

% Performance 3 Incantation
%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all

[dfr, dofs, data] = readV('/Users/Shared/ComedyLab/Data - Raw/Motion Capture/TUESDAY 5pm002 mk5.V', 10);

% The performer's marker frame is now loose and spins slightly on it's mount when performer's head flicks around

data1 = data(1:1060, :); 	% 297.6 - 403.7s

offsets1{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets1{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets1{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets1{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets1{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets1{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets1{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets1{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets1{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets1{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets1{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets1{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets1{13} = [0.079223, 0.949269, -0.304322; -0.975224, 0.137059, 0.173648; 0.206549, 0.283025, 0.936608];

data2 = data(1061:1357, :); 	% 403.8 - 433.3s

offsets2{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets2{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets2{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets2{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets2{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets2{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets2{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets2{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets2{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets2{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets2{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets2{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets2{13} = [0.258897, 0.916712, -0.304322; -0.931154, 0.320622, 0.173648; 0.256758, 0.238414, 0.936608];

data3 = data(1358:1529, :); 	% 433.4 - 450.5s

offsets3{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets3{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets3{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets3{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets3{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets3{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets3{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets3{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets3{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets3{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets3{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets3{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets3{13} = [0.322213, 0.896419, -0.304322; -0.906520, 0.384795, 0.173648; 0.272763, 0.219923, 0.936608];

data4 = data(1530:1808, :); 	% 450.6 - 487.4s
offsets4{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets4{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets4{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets4{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets4{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets4{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets4{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets4{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets4{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets4{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets4{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets4{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets4{13} = [0.841786, 0.421837, -0.336824; -0.384795, 0.906520, 0.173648; 0.378589, -0.016566, 0.925417];

data5 = data(1809:2544, :); % 487.5 - 522.0s
offsets5{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets5{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets5{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets5{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets5{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets5{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets5{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets5{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets5{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets5{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets5{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets5{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets5{13} = [0.911089, 0.147819, -0.384795; -0.085832, 0.981060, 0.173648; 0.403176, -0.125181, 0.906520];

data6 = data(2545:3136, :); % 522.1 - 611.2
offsets6{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets6{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets6{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets6{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets6{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets6{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets6{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets6{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets6{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets6{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets6{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets6{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets6{13} = [0.853518, -0.383344, -0.352924; 0.462339, 0.869534, 0.173648; 0.240312, -0.311382, 0.919397];

data7 = data(3137:4285, :); % 611.3 - 726.1
offsets7{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets7{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets7{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets7{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets7{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets7{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets7{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets7{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets7{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets7{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets7{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets7{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets7{13} = [0.682364, -0.600964, -0.416198; 0.708411, 0.684105, 0.173648; 0.180367, -0.413331, 0.892539];

data8 = data(4286:10588, :); % 726.2 - end
offsets8{1} = [0.162334, -0.948232, -0.272955; 0.968628, 0.205888, -0.139173; 0.188167, -0.241799, 0.951907];
offsets8{2} = [0.767011, 0.607112, -0.207627; -0.628458, 0.776081, -0.052336; 0.129361, 0.170627, 0.976807];
offsets8{3} = [0.984615, 0.085441, 0.152425; 0.118746, -0.967107, -0.224951; 0.128191, 0.239590, -0.962374];
offsets8{4} = [0.260761, -0.836380, -0.482154; 0.964980, 0.240597, 0.104528; 0.028579, -0.492526, 0.869828];
offsets8{5} = [-0.146983, -0.970583, 0.190693; -0.987087, 0.156339, 0.034899; -0.063686, -0.183101, -0.981029];
offsets8{6} = [0.136277, -0.842070, -0.521869; 0.983458, 0.051541, 0.173648; -0.119326, -0.536900, 0.835164];
offsets8{7} = [0.251249, -0.846485, -0.469400; 0.961115, 0.275595, 0.017452; 0.114591, -0.455533, 0.882813];
offsets8{8} = [-0.128205, -0.981982, 0.138834; -0.987856, 0.138834, 0.069756; -0.087774, -0.128205, -0.987856];
offsets8{9} = [-0.993598, 0.043813, 0.104131; -0.034767, -0.995588, 0.087156; 0.107490, 0.082978, 0.990737];
offsets8{10} = [-0.908105, 0.388434, -0.156411; -0.390672, -0.920365, -0.017452; -0.150734, 0.045257, 0.987538];
offsets8{11} = [-0.844692, 0.530693, 0.069714; 0.529597, 0.847531, -0.034899; -0.077606, 0.007441, -0.996956];
offsets8{12} = [-0.601046, 0.573081, -0.557065; -0.728571, -0.679403, 0.087156; -0.328524, 0.458246, 0.825883];
offsets8{13} = [0.563601, -0.694594, -0.447093; 0.816443, 0.550698, 0.173648; 0.125598, -0.462894, 0.877470];

[poseHeaders poseData1 gazeHeaders gazeData1] = analyse(dofs, data1, 297.6, 10, -1, offsets1);
[poseHeaders poseData2 gazeHeaders gazeData2] = analyse(dofs, data2, 403.7, 10, -1, offsets2);
[poseHeaders poseData3 gazeHeaders gazeData3] = analyse(dofs, data3, 433.4, 10, -1, offsets3);
[poseHeaders poseData4 gazeHeaders gazeData4] = analyse(dofs, data4, 450.6, 10, -1, offsets4);
[poseHeaders poseData5 gazeHeaders gazeData5] = analyse(dofs, data5, 478.5, 10, -1, offsets5);
[poseHeaders poseData6 gazeHeaders gazeData6] = analyse(dofs, data6, 552.1, 10, -1, offsets6);
[poseHeaders poseData7 gazeHeaders gazeData7] = analyse(dofs, data7, 611.3, 10, -1, offsets7);
[poseHeaders poseData8 gazeHeaders gazeData8] = analyse(dofs, data8, 726.2, 10, -1, offsets8);

poseData = [poseData1; poseData2; poseData3; poseData4; poseData5; poseData6; poseData7; poseData8];
gazeData = [gazeData1; gazeData2; gazeData3; gazeData4; gazeData5; gazeData6; gazeData7; gazeData8];
writeCSVFile(poseHeaders, poseData, 'TUESDAY 5pm 002.csv');

[glmmHeaders glmmData] = resultsForGLMM(poseHeaders, poseData, gazeData);
writeCSVFile(glmmHeaders, glmmData, 'Performance 3 Mocap.csv');
